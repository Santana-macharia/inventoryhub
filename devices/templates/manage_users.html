{% extends 'dashboard.html' %}
{% load static %}

{% block content %}
<div class="container mx-auto p-4">
  <h2 class="text-2xl font-bold mb-4 text-gray-800">Manage Users</h2>

  <!-- Breadcrumbs -->
  <nav class="text-sm mb-4">
    <ul class="flex space-x-2">
      <li><a href="{% url 'dashboard' %}" class="text-blue-600 hover:text-blue-800 transition duration-200">Dashboard</a></li>
      <li><span class="text-gray-500">/</span></li>
      <li><span class="text-gray-700">Manage Users</span></li>
    </ul>
  </nav>

  <!-- Messages -->
  {% if messages %}
    <div class="mb-4">
      {% for message in messages %}
        <div class="bg-{% if message.tags == 'error' %}red{% else %}green{% endif %}-100 border border-{% if message.tags == 'error' %}red{% else %}green{% endif %}-400 text-{% if message.tags == 'error' %}red{% else %}green{% endif %}-700 px-4 py-3 rounded relative animate__animated animate__fadeIn" role="alert">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Action Buttons -->
  <div class="mb-4 flex flex-col sm:flex-row sm:space-x-4 space-y-2 sm:space-y-0">
    <button onclick="showModal('add')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-200 w-full sm:w-auto">Add User</button>
    {% if request.user.is_superuser %}
      <button onclick="showModal('manage_groups')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-200 w-full sm:w-auto">Manage Groups</button>
    {% endif %}
  </div>

  <!-- Table -->
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border shadow-sm">
      <thead>
        <tr class="bg-gradient-to-r from-blue-600 to-blue-800 text-white">
          <th class="py-3 px-4 border text-left">User Details</th>
          <th class="py-3 px-4 border text-left">Centre & Role</th>
          <th class="py-3 px-4 border text-left">Groups</th>
          <th class="py-3 px-4 border text-left">Actions</th>
        </tr>
      </thead>
      <tbody id="userTableBody">
        {% for user in users %}
          <tr class="hover:bg-gray-50 animate__animated animate__fadeIn transition duration-150" data-user-id="{{ user.pk }}" data-username="{{ user.username }}" data-email="{{ user.email }}" data-first-name="{{ user.first_name|default:'' }}" data-last-name="{{ user.last_name|default:'' }}" data-centre="{{ user.centre.id|default:'' }}" data-is-trainer="{{ user.is_trainer }}" data-is-staff="{{ user.is_staff }}" data-is-superuser="{{ user.is_superuser }}" data-groups="{% for group in user.groups.all %}{{ group.id }}{% if not forloop.last %},{% endif %}{% endfor %}" data-devices-added="{{ user.stats.devices_added }}" data-devices-approved="{{ user.stats.devices_approved|default:'0' }}" data-devices-updated="{{ user.stats.devices_updated|default:'0' }}">
            <td class="py-2 px-4 border">
              <strong>Username:</strong> {{ user.username }}<br>
              <strong>Email:</strong> {{ user.email }}
            </td>
            <td class="py-2 px-4 border">
              <strong>Centre:</strong> {{ user.centre.name|default:"N/A" }}<br>
              <strong>Trainer:</strong> {{ user.is_trainer|yesno:"Yes,No" }}
            </td>
            <td class="py-2 px-4 border">{{ user.groups.all|join:", "|default:"N/A" }}</td>
            <td class="py-2 px-4 border flex space-x-2">
              <button onclick="showModal('view', {{ user.pk }})" class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition duration-200">View</button>
              <button onclick="showModal('update', {{ user.pk }})" class="bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700 transition duration-200">Edit</button>
              <button onclick="showModal('delete', {{ user.pk }})" class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition duration-200">Delete</button>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="4" class="py-2 px-4 border text-center text-gray-600">No users found.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- View Details Modal -->
  <div id="viewModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-7xl mx-4 md:mx-6 max-h-[80vh] md:max-h-[90vh] overflow-y-auto relative animate__animated animate__zoomIn">
      <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 rounded-t-lg flex justify-between items-center">
        <h3 class="text-xl font-semibold">User Details</h3>
        <button onclick="closeModal('viewModal')" class="text-white hover:bg-gray-200 hover:text-gray-800 rounded-full p-2 transition duration-200">&times;</button>
      </div>
      <div class="p-8">
        <div id="loadingSpinner" class="hidden flex justify-center items-center mb-4">
          <svg class="animate-spin h-6 w-6 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
        </div>
        <div class="mb-6">
          <h4 class="text-lg font-bold text-gray-800 mb-2">User Profile</h4>
          <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
            <p class="text-2xl font-semibold text-gray-800" id="viewUsername"></p>
            <p class="text-lg text-gray-600" id="viewEmail"></p>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <h4 class="text-lg font-bold text-gray-800 mb-2">Personal Info</h4>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">First Name:</strong> <span id="viewFirstName" class="text-gray-600"></span></p>
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Last Name:</strong> <span id="viewLastName" class="text-gray-600"></span></p>
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Centre:</strong> <span id="viewCentre" class="text-gray-600"></span></p>
            </div>
          </div>
          <div>
            <h4 class="text-lg font-bold text-gray-800 mb-2">Roles</h4>
            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Is Trainer:</strong> <span id="viewIsTrainer" class="text-gray-600"></span></p>
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Is Staff:</strong> <span id="viewIsStaff" class="text-gray-600"></span></p>
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Is Superuser:</strong> <span id="viewIsSuperuser" class="text-gray-600"></span></p>
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold">Groups:</strong> <span id="viewGroups" class="text-gray-600"></span></p>
            </div>
          </div>
        </div>
        <div class="mt-8">
          <h4 class="text-lg font-bold text-gray-800 mb-2">Activity Stats</h4>
          <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
            <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold" title="Number of devices added by this user">Devices Added:</strong> <span id="viewDevicesAdded" class="text-gray-600"></span></p>
            {% if request.user.is_superuser %}
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold" title="Number of devices approved by this user">Devices Approved:</strong> <span id="viewDevicesApproved" class="text-gray-600"></span></p>
            {% endif %}
            {% if request.user.is_trainer %}
              <p class="mb-4 text-sm md:text-base"><strong class="text-gray-700 font-semibold" title="Number of device update requests submitted by this user">Devices Updated:</strong> <span id="viewDevicesUpdated" class="text-gray-600"></span></p>
            {% endif %}
          </div>
        </div>
        <div class="mt-6 flex justify-end">
          <button class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200" onclick="closeModal('viewModal')">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Update User Modal -->
  <div id="userModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-7xl mx-4 md:mx-6 max-h-[80vh] md:max-h-[90vh] overflow-y-auto relative animate__animated animate__zoomIn">
      <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 rounded-t-lg flex justify-between items-center">
        <h3 id="modalTitle" class="text-xl font-semibold"></h3>
        <button onclick="closeModal('userModal')" class="text-white hover:bg-gray-200 hover:text-gray-800 rounded-full p-2 transition duration-200">&times;</button>
      </div>
      <div class="p-8">
        <form id="userForm" method="post" action="" class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {% csrf_token %}
          <input type="hidden" id="userId" name="user_id">
          <div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Username</label>
              <input type="text" name="username" id="username" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            </div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Email</label>
              <input type="email" name="email" id="email" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            </div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Password</label>
              <input type="password" name="password" id="password" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
          </div>
          <div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">First Name</label>
              <input type="text" name="first_name" id="first_name" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Last Name</label>
              <input type="text" name="last_name" id="last_name" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Centre</label>
              <select name="centre" id="centre" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">Select Centre</option>
                {% for centre in centres %}
                  <option value="{{ centre.id }}">{{ centre.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div>
            <div class="mb-4">
              <label class="block text-gray-700 font-medium mb-1">Groups</label>
              <select name="groups" id="groups" multiple class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                {% for group in groups %}
                  <option value="{{ group.id }}">{{ group.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="mb-4 flex flex-col space-y-2">
              <label class="flex items-center">
                <input type="checkbox" name="is_trainer" id="is_trainer" class="mr-2">
                <span class="text-gray-700 font-medium">Is Trainer</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="is_staff" id="is_staff" class="mr-2">
                <span class="text-gray-700 font-medium">Is Staff</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="is_superuser" id="is_superuser" class="mr-2">
                <span class="text-gray-700 font-medium">Is Superuser</span>
              </label>
            </div>
          </div>
          <div class="col-span-1 md:col-span-3 flex justify-end space-x-3">
            <button type="button" onclick="closeModal('userModal')" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200">Cancel</button>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-200">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4 animate__animated animate__zoomIn">
      <h3 class="text-lg font-bold mb-4 text-gray-800">Delete User</h3>
      <p class="text-gray-600 mb-4">Are you sure you want to delete this user (<span id="deleteUsername"></span>)?</p>
      <form id="deleteForm" method="post" action="">
        {% csrf_token %}
        <input type="hidden" id="deleteUserId" name="user_id">
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeModal('deleteModal')" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200">Cancel</button>
          <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition duration-200">Delete</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Manage Groups Modal -->
  <div id="groupModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4 animate__animated animate__zoomIn">
      <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 rounded-t-lg flex justify-between items-center">
        <h3 class="text-xl font-semibold">Manage Groups</h3>
        <button onclick="closeModal('groupModal')" class="text-white hover:bg-gray-200 hover:text-gray-800 rounded-full p-2 transition duration-200">&times;</button>
      </div>
      <div class="p-6">
        <form id="groupForm" method="post" action="{% url 'manage_groups' %}">
          {% csrf_token %}
          <div class="mb-4">
            <label class="block text-gray-700 font-medium mb-1">New Group Name</label>
            <input type="text" name="group_name" id="group_name" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div class="flex justify-end space-x-3">
            <button type="button" onclick="closeModal('groupModal')" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200">Cancel</button>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-200">Add Group</button>
          </div>
        </form>
        <div class="mt-4">
          <h4 class="text-lg font-semibold text-gray-700">Existing Groups</h4>
          <ul class="list-disc pl-5 space-y-2">
            {% for group in groups %}
              <li class="flex items-center space-x-4">
                {{ group.name }}
                <button onclick="showPermissionsModal({{ group.id }})" class="text-blue-600 hover:text-blue-800 transition duration-200">Manage Permissions</button>
                <form method="post" action="{% url 'delete_group' %}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this group?');">
                  {% csrf_token %}
                  <input type="hidden" name="group_id" value="{{ group.id }}">
                  <button type="submit" class="text-red-600 hover:text-red-800 transition duration-200">Delete</button>
                </form>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Manage Permissions Modal -->
  <div id="permissionsModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4 animate__animated animate__zoomIn">
      <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 rounded-t-lg flex justify-between items-center">
        <h3 class="text-xl font-semibold">Manage Permissions</h3>
        <button onclick="closeModal('permissionsModal')" class="text-white hover:bg-gray-200 hover:text-gray-800 rounded-full p-2 transition duration-200">&times;</button>
      </div>
      <div class="p-6">
        <form id="permissionsForm" method="post" action="{% url 'update_group_permissions' %}">
          {% csrf_token %}
          <div class="mb-4">
            <label class="block text-gray-700 font-medium mb-1">Select Group</label>
            <select name="group_id" id="group_select" class="border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
              {% for group in groups %}
                <option value="{{ group.id }}">{{ group.name }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="grid grid-cols-1 gap-2 max-h-[50vh] overflow-y-auto">
            {% for perm in permissions %}
              <div class="flex items-center">
                <input type="checkbox" name="permissions" value="{{ perm.id }}" id="perm_{{ perm.id }}" class="mr-2">
                <label for="perm_{{ perm.id }}" class="text-gray-700">{{ perm.codename }} ({{ perm.content_type.model }})</label>
              </div>
            {% endfor %}
          </div>
          <div class="flex justify-end space-x-3 mt-4">
            <button type="button" onclick="closeModal('permissionsModal')" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200">Cancel</button>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-200">Save Permissions</button>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>

<script>
const groupsData = {
  {% for group in groups %}
  "{{ group.id }}": {
    permissions: [{% for perm in group.permissions.all %}"{{ perm.id }}",{% endfor %}]
  },
  {% endfor %}
};

function showModal(action, userId = null) {
  const userModal = document.getElementById('userModal');
  const deleteModal = document.getElementById('deleteModal');
  const groupModal = document.getElementById('groupModal');
  const viewModal = document.getElementById('viewModal');
  const loadingSpinner = document.getElementById('loadingSpinner');
  const modalTitle = document.getElementById('modalTitle');
  const userForm = document.getElementById('userForm');
  const deleteForm = document.getElementById('deleteForm');

  if (action === 'add') {
    modalTitle.textContent = 'Add User';
    userForm.action = "{% url 'user_add' %}";
    document.getElementById('userId').value = '';
    document.getElementById('username').value = '';
    document.getElementById('email').value = '';
    document.getElementById('password').value = '';
    document.getElementById('first_name').value = '';
    document.getElementById('last_name').value = '';
    document.getElementById('centre').value = '';
    document.getElementById('groups').value = [];
    document.getElementById('is_trainer').checked = false;
    document.getElementById('is_staff').checked = false;
    document.getElementById('is_superuser').checked = false;
    document.getElementById('centre').required = false;
    userModal.classList.remove('hidden');
  } else if (action === 'update' && userId) {
    modalTitle.textContent = 'Update User';
    userForm.action = "{% url 'user_update' user.pk %}".replace('{{ user.pk }}', userId);
    const row = document.querySelector(`tr[data-user-id="${userId}"]`);
    if (row) {
      document.getElementById('userId').value = userId;
      document.getElementById('username').value = row.dataset.username;
      document.getElementById('email').value = row.dataset.email;
      document.getElementById('first_name').value = row.dataset.firstName;
      document.getElementById('last_name').value = row.dataset.lastName;
      document.getElementById('centre').value = row.dataset.centre || '';
      const groupIds = row.dataset.groups ? row.dataset.groups.split(',') : [];
      const groupsSelect = document.getElementById('groups');
      Array.from(groupsSelect.options).forEach(option => {
        option.selected = groupIds.includes(option.value);
      });
      document.getElementById('is_trainer').checked = row.dataset.isTrainer === 'true';
      document.getElementById('is_staff').checked = row.dataset.isStaff === 'true';
      document.getElementById('is_superuser').checked = row.dataset.isSuperuser === 'true';
      document.getElementById('password').value = '';
      document.getElementById('centre').required = row.dataset.isTrainer === 'true' && row.dataset.isSuperuser !== 'true';
    }
    userModal.classList.remove('hidden');
  } else if (action === 'delete' && userId) {
    deleteForm.action = "{% url 'user_delete' user.pk %}".replace('{{ user.pk }}', userId);
    document.getElementById('deleteUserId').value = userId;
    const row = document.querySelector(`tr[data-user-id="${userId}"]`);
    document.getElementById('deleteUsername').textContent = row ? row.dataset.username : '';
    deleteModal.classList.remove('hidden');
  } else if (action === 'view' && userId) {
    loadingSpinner.classList.remove('hidden');
    const row = document.querySelector(`tr[data-user-id="${userId}"]`);
    if (row) {
      document.getElementById('viewUsername').textContent = row.dataset.username;
      document.getElementById('viewEmail').textContent = row.dataset.email;
      document.getElementById('viewFirstName').textContent = row.dataset.firstName || 'N/A';
      document.getElementById('viewLastName').textContent = row.dataset.lastName || 'N/A';
      document.getElementById('viewCentre').textContent = row.dataset.centre ? Array.from(document.getElementById('centre').options).find(opt => opt.value === row.dataset.centre)?.text || 'N/A' : 'N/A';
      document.getElementById('viewGroups').textContent = row.dataset.groups ? Array.from(document.getElementById('groups').options).filter(opt => row.dataset.groups.split(',').includes(opt.value)).map(opt => opt.text).join(', ') || 'N/A' : 'N/A';
      document.getElementById('viewIsTrainer').textContent = row.dataset.isTrainer === 'true' ? 'Yes' : 'No';
      document.getElementById('viewIsStaff').textContent = row.dataset.isStaff === 'true' ? 'Yes' : 'No';
      document.getElementById('viewIsSuperuser').textContent = row.dataset.isSuperuser === 'true' ? 'Yes' : 'No';
      document.getElementById('viewDevicesAdded').textContent = row.dataset.devicesAdded || '0';
      {% if request.user.is_superuser %}
      document.getElementById('viewDevicesApproved').textContent = row.dataset.devicesApproved || '0';
      {% endif %}
      {% if request.user.is_trainer %}
      document.getElementById('viewDevicesUpdated').textContent = row.dataset.devicesUpdated || '0';
      {% endif %}
    }
    loadingSpinner.classList.add('hidden');
    viewModal.classList.remove('hidden');
  } else if (action === 'manage_groups') {
    groupModal.classList.remove('hidden');
  }
}

function showPermissionsModal(groupId) {
  const permissionsModal = document.getElementById('permissionsModal');
  document.getElementById('group_select').value = groupId;
  const perms = groupsData[groupId]?.permissions || [];
  document.querySelectorAll('input[name="permissions"]').forEach(checkbox => {
    checkbox.checked = perms.includes(checkbox.value);
  });
  permissionsModal.classList.remove('hidden');
}

function closeModal(modalId) {
  document.getElementById(modalId).classList.add('hidden');
}

document.getElementById('userForm').addEventListener('submit', function(e) {
  if (!document.getElementById('userId').value && !document.getElementById('password').value) {
    e.preventDefault();
    alert('Password is required for new users.');
  }
});

document.getElementById('is_trainer').addEventListener('change', function() {
  const isTrainer = this.checked;
  const isSuperuser = document.getElementById('is_superuser').checked;
  document.getElementById('centre').required = isTrainer && !isSuperuser;
});

document.getElementById('is_superuser').addEventListener('change', function() {
  const isSuperuser = this.checked;
  const isTrainer = document.getElementById('is_trainer').checked;
  document.getElementById('centre').required = isTrainer && !isSuperuser;
});

document.addEventListener('DOMContentLoaded', function() {
  const rows = document.querySelectorAll('#userTableBody tr');
  rows.forEach((row, index) => {
    row.style.animationDelay = `${index * 0.1}s`;
  });
});
</script>
{% endblock %}